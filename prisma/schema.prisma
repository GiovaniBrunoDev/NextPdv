generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Produto {
  id            Int               @id @default(autoincrement())
  nome          String
  preco         Float
  custoUnitario Float
  outrosCustos  Float
  imagemUrl     String?
  variacoes     VariacaoProduto[]
}

model VariacaoProduto {
  id        Int         @id @default(autoincrement())
  produtoId Int
  numeracao String
  estoque   Int
  itens     ItemVenda[]
  produto   Produto     @relation(fields: [produtoId], references: [id], onDelete: Cascade)
}

model ItemVenda {
  id                Int             @id @default(autoincrement())
  vendaId           Int
  variacaoProdutoId Int
  quantidade        Int
  variacaoProduto   VariacaoProduto @relation(fields: [variacaoProdutoId], references: [id])
  venda             Venda           @relation(fields: [vendaId], references: [id])
}

model Venda {
  id             Int         @id @default(autoincrement())
  data           DateTime    @default(now())
  total          Float
  formaPagamento String?
  tipoEntrega    String?
  taxaEntrega    Float?
  entregador     String?
  endereco       String?
  clienteId      Int?
  itens          ItemVenda[]
  cliente        Cliente?    @relation(fields: [clienteId], references: [id])
}

model Cliente {
  id          Int     @id @default(autoincrement())
  nome        String
  telefone    String?
  endereco    String?
  bairro      String?
  cidade      String?
  estado      String?
  cep         String?
  observacoes String?
  vendas      Venda[]
}

model Meta {
  id          Int      @id @default(autoincrement())
  titulo      String
  descricao   String?
  valorMeta   Float
  tipo        String   // "vendas", "lucro", "produtosVendidos", "clientes"
  periodo     String   // "dia", "semana", "mes"
  criadoEm    DateTime @default(now())
  atualizadoEm DateTime @updatedAt
}
